<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargar Fixture Mayores</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #1e1e1e;
            color: #f1f1f1;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 2rem;
        }

        .form-container {
            background-color: #2b2b2b;
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.3);
            width: 100%;
            max-width: 700px;
        }

        h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: #00bfff;
            font-weight: bold;
        }

        .form-control, .form-select {
            background-color: #1e1e1e;
            border: 1px solid #00bfff;
            color: #f1f1f1;
        }

        .form-control:focus, .form-select:focus {
            border-color: #00bfff;
            box-shadow: 0 0 6px #00bfff;
        }

        .btn-primary {
            background-color: #00bfff;
            border: none;
            font-weight: 600;
            width: 100%;
            margin-top: 1.4rem;
        }

        .btn-primary:hover {
            background-color: #0099cc;
        }
        .back-link {
            display: block;
            text-align: center;
            margin-top: 1rem;
            color: #ccc;
        }

        .back-link:hover {
            color: #4fc3f7;
        }
    </style>
</head>

<body>

<div class="form-container">

    <h2>Cargar Fixture Mayores</h2>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% set last = messages[-1] %}
            <div class="alert alert-{{ 'danger' if last[0]=='error' else last[0] }}">
                {{ last[1] }}
            </div>
        {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('views.cargar_fixture_mayores') }}">

        <!-- Jornada -->
        <label class="mt-2">Jornada:</label>
        <select name="jornada" id="jornada" class="form-select" required>
            <option value="">Seleccionar jornada</option>
            {% for j in range(1, total_jornadas + 1) %}
            <option value="{{ j }}">{{ j }}</option>
            {% endfor %}
        </select>


        <!-- Club Local -->
        <label class="mt-3">Club Local:</label>
        <select name="club_local" id="club_local" class="form-select" required onchange="actualizarEquipoLocal()">
            <option value="">Seleccionar club</option>
            {% for club in clubes %}
            <option value="{{ club.id }}">{{ club.nombre }}</option>
            {% endfor %}
        </select>

        <input type="hidden" name="equipo_local" id="equipo_local">

        <!-- Club Visitante -->
        <label class="mt-3">Club Visitante:</label>
        <select name="club_visitante" id="club_visitante" class="form-select" required onchange="actualizarEquipoVisitante()">
            <option value="">Seleccionar club</option>
            {% for club in clubes %}
            <option value="{{ club.id }}">{{ club.nombre }}</option>
            {% endfor %}
        </select>

        <input type="hidden" name="equipo_visitante" id="equipo_visitante">

        <button type="submit" class="btn btn-primary mt-4">Crear partido</button>

    </form>
    <a href="{{ url_for('views.adminview') }}" class="back-link text-align-center">← Volver al panel del administrador</a>

</div>

<script>
    // Guardamos una copia original de los clubes para poder reconstruir las listas
    const clubesOriginales = [
        {% for club in clubes %}
            { id: "{{ club.id }}", nombre: "{{ club.nombre }}" }{% if not loop.last %},{% endif %}
        {% endfor %}
    ];


    function actualizarOpciones() {
        const localSelect = document.getElementById("club_local");
        const visitanteSelect = document.getElementById("club_visitante");

        const localSeleccionado = localSelect.value;
        const visitanteSeleccionado = visitanteSelect.value;

        // Limpiar selects
        localSelect.innerHTML = '<option value="">Seleccionar club</option>';
        visitanteSelect.innerHTML = '<option value="">Seleccionar club</option>';

        clubesOriginales.forEach(club => {

            // Para el select Local → NO mostrar el visitante elegido
            if (club.id !== visitanteSeleccionado) {
                let optLocal = document.createElement("option");
                optLocal.value = club.id;
                optLocal.textContent = club.nombre;

                if (club.id === localSeleccionado) optLocal.selected = true;
                localSelect.appendChild(optLocal);
            }

            // Para el select Visitante → NO mostrar el local elegido
            if (club.id !== localSeleccionado) {
                let optVisit = document.createElement("option");
                optVisit.value = club.id;
                optVisit.textContent = club.nombre;

                if (club.id === visitanteSeleccionado) optVisit.selected = true;
                visitanteSelect.appendChild(optVisit);
            }
        });
    }

    // Cuando elige local o visitante → se actualizan los selects
    document.getElementById("club_local").addEventListener("change", actualizarOpciones);
    document.getElementById("club_visitante").addEventListener("change", actualizarOpciones);

    // Cargar listas iniciales
    actualizarOpciones();
</script>



</body>
</html>



